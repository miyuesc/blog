# ES2015-ES2025 æ–°ç‰¹æ€§å®Œå…¨æŒ‡å—

## ES2015 (ES6) - åŸºç¡€ç‰¹æ€§

**ç‰ˆæœ¬å½±å“ï¼š** ES2015 æ˜¯ JavaScript å†å²ä¸Šæœ€é‡è¦çš„ç‰ˆæœ¬æ›´æ–°ï¼Œå¼•å…¥äº†ç°ä»£ JavaScript çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå½»åº•æ”¹å˜äº† JavaScript çš„ç¼–ç¨‹èŒƒå¼ã€‚å®ƒå¥ å®šäº†ç°ä»£å‰ç«¯å¼€å‘çš„åŸºç¡€ï¼Œæ˜¯ä»ä¼ ç»Ÿ JavaScript å‘ç°ä»£ JavaScript è½¬å˜çš„åˆ†æ°´å²­ã€‚

### 1. let å’Œ const
**let**ï¼šå—çº§ä½œç”¨åŸŸå˜é‡å£°æ˜ï¼Œé¿å…å˜é‡æå‡å’Œé‡å¤å£°æ˜ã€‚
**const**ï¼šå£°æ˜å¸¸é‡ï¼Œèµ‹å€¼åä¸å¯æ›´æ”¹ã€‚
```javascript
// let ç¤ºä¾‹
let x = 1;
{
  let x = 2; // ä¸åŒçš„å—çº§ä½œç”¨åŸŸ
  console.log(x); // 2
}
console.log(x); // 1

// const ç¤ºä¾‹
const PI = 3.14159;
const obj = { name: 'John' };
obj.name = 'Jane'; // å¯ä»¥ä¿®æ”¹å¯¹è±¡å±æ€§
// obj = {}; // é”™è¯¯ï¼šä¸èƒ½é‡æ–°èµ‹å€¼
```

### 2. ç®­å¤´å‡½æ•° (Arrow Functions)
ç®€æ´çš„å‡½æ•°å†™æ³•ï¼Œè‡ªåŠ¨ç»‘å®šå¤–éƒ¨ thisã€‚
```javascript
// åŸºæœ¬è¯­æ³•
const add = (a, b) => a + b;

// å¤šè¡Œå‡½æ•°ä½“
const multiply = (a, b) => {
  const result = a * b;
  return result;
};

// this ç»‘å®šç¤ºä¾‹
class Counter {
  constructor() {
    this.count = 0;
  }
  
  start() {
    setInterval(() => {
      this.count++; // this æ­£ç¡®ç»‘å®šåˆ° Counter å®ä¾‹
      console.log(this.count);
    }, 1000);
  }
}
```

### 3. æ¨¡æ¿å­—ç¬¦ä¸² (Template Literals)
ä½¿ç”¨åå¼•å· ``ï¼Œæ”¯æŒå¤šè¡Œå’Œå˜é‡æ’å€¼ã€‚
```javascript
// åŸºæœ¬æ’å€¼
const name = 'World';
const greeting = `Hello ${name}!`;

// å¤šè¡Œå­—ç¬¦ä¸²
const html = `
  <div>
    <h1>${title}</h1>
    <p>${content}</p>
  </div>
`;

// æ ‡ç­¾æ¨¡æ¿
function highlight(strings, ...values) {
  return strings.reduce((result, str, i) => 
    result + str + (values[i] ? `<span>${values[i]}</span>` : ''), '');
}
const highlighted = highlight`Hello ${name}!`;
```

### 4. è§£æ„èµ‹å€¼ (Destructuring)
å¿«é€Ÿä»æ•°ç»„æˆ–å¯¹è±¡ä¸­æå–å€¼ã€‚
```javascript
// æ•°ç»„è§£æ„
const [a, b, ...rest] = [1, 2, 3, 4, 5];
console.log(a, b, rest); // 1, 2, [3, 4, 5]

// å¯¹è±¡è§£æ„
const { name, age: userAge, ...otherProps } = { 
  name: 'Tom', 
  age: 18, 
  city: 'New York' 
};
console.log(name, userAge, otherProps); // 'Tom', 18, { city: 'New York' }

// é»˜è®¤å€¼
const { title = 'Untitled' } = {};
console.log(title); // 'Untitled'

// åµŒå¥—è§£æ„
const { user: { name: userName } } = { user: { name: 'John' } };
console.log(userName); // 'John'
```

### 5. é»˜è®¤å‚æ•°ã€å‰©ä½™å‚æ•°ã€æ‰©å±•è¿ç®—ç¬¦
```javascript
// é»˜è®¤å‚æ•°
function greet(name = 'Guest') {
  console.log(`Hello, ${name}!`);
}

// å‰©ä½™å‚æ•°
function sum(...numbers) {
  return numbers.reduce((total, n) => total + n, 0);
}

// æ‰©å±•è¿ç®—ç¬¦
const arr1 = [1, 2, 3];
const arr2 = [...arr1, 4, 5];

// for...of
for (const char of 'hello') {
  console.log(char);
}
```

## ES2015 (ES6) - é«˜çº§ç‰¹æ€§

**ç‰ˆæœ¬å½±å“ï¼š** è¿™äº›é«˜çº§ç‰¹æ€§ä¸º JavaScript å¸¦æ¥äº†é¢å‘å¯¹è±¡ç¼–ç¨‹ã€å‡½æ•°å¼ç¼–ç¨‹å’Œå…ƒç¼–ç¨‹çš„èƒ½åŠ›ï¼Œä½¿ JavaScript æˆä¸ºä¸€é—¨çœŸæ­£ç°ä»£åŒ–çš„ç¼–ç¨‹è¯­è¨€ã€‚

### 1. ç±»å’Œæ¨¡å— (Classes & Modules)
æ›´æ¥è¿‘ä¼ ç»Ÿé¢å‘å¯¹è±¡å†™æ³•ï¼Œæ”¯æŒç»§æ‰¿å’Œæ¨¡å—åŒ–å¯¼å…¥å¯¼å‡ºã€‚
```javascript
// ç±»å®šä¹‰
class Person {
  constructor(name) {
    this.name = name;
  }
  
  sayHello() {
    console.log(`Hello, ${this.name}!`);
  }
  
  static create(name) {
    return new Person(name);
  }
}

// ç»§æ‰¿
class Employee extends Person {
  constructor(name, role) {
    super(name);
    this.role = role;
  }
  
  sayHello() {
    super.sayHello();
    console.log(`I am a ${this.role}`);
  }
}

// æ¨¡å—å¯¼å‡º
export class User extends Person {}
export const helper = () => {};

// æ¨¡å—å¯¼å…¥
import { User, helper } from './user.js';
```

### 2. Promise
ç»Ÿä¸€å¼‚æ­¥ç¼–ç¨‹æ¥å£ï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('done');
  }, 1000);
});

promise
  .then(result => console.log(result))
  .catch(error => console.error(error));

// é“¾å¼è°ƒç”¨
fetch('api/data')
  .then(response => response.json())
  .then(data => processData(data))
  .catch(error => handleError(error));

// Promise.all
Promise.all([
  fetch('api/users'),
  fetch('api/posts')
])
  .then(([users, posts]) => {
    // å¤„ç†æ‰€æœ‰è¯·æ±‚ç»“æœ
  });

// Promise.race
Promise.race([
  fetch('api/data'),
  new Promise((_, reject) => 
    setTimeout(() => reject(new Error('Timeout')), 5000)
  )
]);
```

### 3. ç”Ÿæˆå™¨å’Œè¿­ä»£å™¨ (Generators & Iterators)
ç”Ÿæˆå™¨å‡½æ•°å¯æš‚åœå’Œæ¢å¤æ‰§è¡Œï¼Œé€‚åˆå¼‚æ­¥æµç¨‹å’Œè‡ªå®šä¹‰è¿­ä»£ã€‚
```javascript
// åŸºæœ¬ç”Ÿæˆå™¨
function* generator() {
  yield 1;
  yield 2;
  yield 3;
}

for (const value of generator()) {
  console.log(value);
}

// å¼‚æ­¥ç”Ÿæˆå™¨
async function* asyncGenerator() {
  yield await Promise.resolve(1);
  yield await Promise.resolve(2);
}

// è‡ªå®šä¹‰è¿­ä»£å™¨
const iterable = {
  *[Symbol.iterator]() {
    yield 1;
    yield 2;
    yield 3;
  }
};

for (const value of iterable) {
  console.log(value);
}
```

### 4. Map/Set/WeakMap/WeakSet
æ–°çš„é›†åˆç±»å‹ï¼Œæ”¯æŒä»»æ„ç±»å‹é”®å’Œå€¼ã€‚
```javascript
// Map
const map = new Map();
map.set('key', 'value');
map.set(1, 'number');
map.set({}, 'object');

// Set
const set = new Set([1, 2, 3, 3, 4]); // è‡ªåŠ¨å»é‡
console.log([...set]); // [1, 2, 3, 4]

// WeakMap
const weakMap = new WeakMap();
const obj = {};
weakMap.set(obj, 'value');
// å½“ obj è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œå¯¹åº”çš„å€¼ä¹Ÿä¼šè¢«å›æ”¶

// WeakSet
const weakSet = new WeakSet();
weakSet.add(obj);
// å½“ obj è¢«åƒåœ¾å›æ”¶æ—¶ï¼Œä¼šè‡ªåŠ¨ä» weakSet ä¸­ç§»é™¤
```

### 5. Symbol
å”¯ä¸€å€¼çš„åŸºæœ¬ç±»å‹ï¼Œå¸¸ç”¨äºå¯¹è±¡å±æ€§åé¿å…å†²çªã€‚
```javascript
// åˆ›å»º Symbol
const sym1 = Symbol('description');
const sym2 = Symbol('description');
console.log(sym1 === sym2); // false

// ä½œä¸ºå¯¹è±¡å±æ€§
const obj = {
  [sym1]: 'value'
};

// å†…ç½® Symbol
class MyArray extends Array {
  static get [Symbol.species]() {
    return Array;
  }
}

// Symbol.iterator
const iterable = {
  *[Symbol.iterator]() {
    yield 1;
    yield 2;
  }
};
```

### 6. Proxy & Reflect
å…ƒç¼–ç¨‹èƒ½åŠ›ï¼Œæ‹¦æˆªå¯¹è±¡æ“ä½œã€‚
```javascript
// Proxy ç¤ºä¾‹
const target = { foo: 'bar' };
const handler = {
  get(obj, prop) {
    return prop in obj ? obj[prop] : 'default';
  },
  set(obj, prop, value) {
    if (typeof value === 'string') {
      obj[prop] = value;
      return true;
    }
    return false;
  }
};

const proxy = new Proxy(target, handler);
console.log(proxy.foo); // 'bar'
console.log(proxy.abc); // 'default'

// Reflect ç¤ºä¾‹
const obj = { x: 1, y: 2 };
Reflect.set(obj, 'z', 3);
console.log(Reflect.get(obj, 'z')); // 3
```

### 7. å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡æ–°æ–¹æ³•
```javascript
// å­—ç¬¦ä¸²æ–°æ–¹æ³•
'hello'.includes('ell'); // true
'hello'.startsWith('he'); // true
'hello'.endsWith('lo'); // true
'hello'.repeat(3); // 'hellohellohello'

// æ•°ç»„æ–°æ–¹æ³•
[1, 2, 3].find(x => x > 1); // 2
[1, 2, 3].findIndex(x => x > 1); // 1
Array.from('hello'); // ['h', 'e', 'l', 'l', 'o']
Array.of(1, 2, 3); // [1, 2, 3]

// å¯¹è±¡æ–°æ–¹æ³•
Object.assign({}, { a: 1 }, { b: 2 }); // { a: 1, b: 2 }
Object.is(NaN, NaN); // true
Object.setPrototypeOf(obj, proto);
```



## ES2016 (ES7)

**ç‰ˆæœ¬å½±å“ï¼š** ES2016 æ˜¯ä¸€ä¸ªå°ç‰ˆæœ¬æ›´æ–°ï¼Œå¼•å…¥äº†ä¸¤ä¸ªå®ç”¨çš„ç‰¹æ€§ã€‚è™½ç„¶ç‰¹æ€§ä¸å¤šï¼Œä½† Array.includes() æˆä¸ºäº†æ—¥å¸¸å¼€å‘ä¸­çš„å¸¸ç”¨æ–¹æ³•ï¼ŒæŒ‡æ•°è¿ç®—ç¬¦åˆ™æä¾›äº†æ›´ç®€æ´çš„æ•°å­¦è¿ç®—è¯­æ³•ã€‚

### 1. Array.prototype.includes()
åˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«æŸå…ƒç´ ï¼Œæ”¯æŒ NaNã€‚
```javascript
const array = [1, 2, NaN];
console.log(array.includes(NaN)); // true
console.log(array.includes(2)); // true
console.log(array.includes(3)); // false

// ä¸ indexOf çš„åŒºåˆ«
console.log([NaN].indexOf(NaN)); // -1
console.log([NaN].includes(NaN)); // true
```

### 2. æŒ‡æ•°è¿ç®—ç¬¦ (Exponentiation Operator)
2 ** 3 ç­‰ä»·äº Math.pow(2, 3)
```javascript
const result = 2 ** 3; // 8
const square = 2 ** 2; // 4
const cube = 2 ** 3; // 8

// ä¸ Math.pow çš„åŒºåˆ«
console.log(2 ** 3 ** 2); // 512 (å³ç»“åˆ)
console.log(Math.pow(2, Math.pow(3, 2))); // 512
```



## ES2017 (ES8)

**ç‰ˆæœ¬å½±å“ï¼š** ES2017 å¸¦æ¥äº†é©å‘½æ€§çš„ async/await è¯­æ³•ï¼Œå½»åº•æ”¹å˜äº† JavaScript å¼‚æ­¥ç¼–ç¨‹çš„å†™æ³•ï¼Œä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ä¸€æ ·æ¸…æ™°ã€‚åŒæ—¶å¢å¼ºäº†å¯¹è±¡æ“ä½œèƒ½åŠ›ï¼Œä¸ºç°ä»£ JavaScript å¼€å‘å¥ å®šäº†é‡è¦åŸºç¡€ã€‚

### 1. async/await
åŸºäº Promise çš„å¼‚æ­¥ç¼–ç¨‹è¯­æ³•ç³–ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
async function fetchData() {
  try {
    const response = await fetch('api/data');
    const data = await response.json();
    return data;
  } catch (error) {
    console.error('Error:', error);
  }
}

// å¹¶è¡Œè¯·æ±‚
async function fetchMultiple() {
  const [users, posts] = await Promise.all([
    fetch('api/users').then(r => r.json()),
    fetch('api/posts').then(r => r.json())
  ]);
  return { users, posts };
}

// å¼‚æ­¥è¿­ä»£
async function* asyncGenerator() {
  yield await Promise.resolve(1);
  yield await Promise.resolve(2);
}
```

### 2. Object.values() å’Œ Object.entries()
å¿«é€Ÿè·å–å¯¹è±¡çš„å€¼æ•°ç»„æˆ–é”®å€¼å¯¹æ•°ç»„ã€‚
```javascript
const obj = { a: 1, b: 2, c: 3 };

// Object.values
console.log(Object.values(obj)); // [1, 2, 3]

// Object.entries
for (const [key, value] of Object.entries(obj)) {
  console.log(`${key}: ${value}`);
}

// è½¬æ¢ä¸º Map
const map = new Map(Object.entries(obj));
```

### 3. String padding
å­—ç¬¦ä¸²è¡¥å…¨ã€‚
```javascript
// padStart
'x'.padStart(5, 'a'); // 'aaaax'
'123'.padStart(5, '0'); // '00123'

// padEnd
'x'.padEnd(5, 'a'); // 'xaaaa'
'123'.padEnd(5, '0'); // '12300'

// å®é™…åº”ç”¨
function formatNumber(num) {
  return num.toString().padStart(2, '0');
}
console.log(formatNumber(5)); // '05'
```

### 4. Object.getOwnPropertyDescriptors
è·å–å¯¹è±¡æ‰€æœ‰å±æ€§æè¿°ç¬¦ã€‚
```javascript
const obj = {
  get name() {
    return 'John';
  }
};

const descriptors = Object.getOwnPropertyDescriptors(obj);
console.log(descriptors.name.get); // [Function: get name]

// ç”¨äºå…‹éš†å¯¹è±¡
const clone = Object.create(
  Object.getPrototypeOf(obj),
  Object.getOwnPropertyDescriptors(obj)
);
```

### 5. SharedArrayBuffer & Atomics
å¤šçº¿ç¨‹å…±äº«å†…å­˜å’ŒåŸå­æ“ä½œï¼Œé€‚åˆé«˜æ€§èƒ½åœºæ™¯ã€‚
```javascript
// åˆ›å»ºå…±äº«å†…å­˜
const buffer = new SharedArrayBuffer(1024);
const view = new Int32Array(buffer);

// åŸå­æ“ä½œ
Atomics.store(view, 0, 123);
const value = Atomics.load(view, 0);
Atomics.add(view, 0, 1);
```



## ES2018 (ES9)

**ç‰ˆæœ¬å½±å“ï¼š** ES2018 è¿›ä¸€æ­¥å®Œå–„äº†å¼‚æ­¥ç¼–ç¨‹èƒ½åŠ›ï¼Œå¼•å…¥äº†å¼‚æ­¥è¿­ä»£ï¼ŒåŒæ—¶å¢å¼ºäº†å¯¹è±¡æ“ä½œå’Œæ­£åˆ™è¡¨è¾¾å¼åŠŸèƒ½ã€‚Rest/Spread å±æ€§çš„å¼•å…¥ä½¿å¯¹è±¡æ“ä½œæ›´åŠ çµæ´»ï¼Œæˆä¸ºç°ä»£ JavaScript å¼€å‘çš„é‡è¦å·¥å…·ã€‚

### 1. å¼‚æ­¥è¿­ä»£ (Async Iteration)
æ”¯æŒ for await...of è¯­æ³•ï¼Œå¼‚æ­¥éå†ã€‚
```javascript
// å¼‚æ­¥ç”Ÿæˆå™¨
async function* asyncGenerator() {
  yield await Promise.resolve(1);
  yield await Promise.resolve(2);
  yield await Promise.resolve(3);
}

// å¼‚æ­¥è¿­ä»£
(async () => {
  for await (const value of asyncGenerator()) {
    console.log(value);
  }
})();

// å®é™…åº”ç”¨ï¼šè¯»å–æ–‡ä»¶æµ
async function processFile(file) {
  for await (const chunk of file.stream()) {
    processChunk(chunk);
  }
}
```

### 2. Rest/Spread å±æ€§
å¯¹è±¡å‰©ä½™/æ‰©å±•å±æ€§ã€‚
```javascript
// å¯¹è±¡è§£æ„
const { x, y, ...rest } = { x: 1, y: 2, a: 3, b: 4 };
console.log(rest); // { a: 3, b: 4 }

// å¯¹è±¡åˆå¹¶
const obj1 = { foo: 'bar', x: 42 };
const obj2 = { foo: 'baz', y: 13 };
const clonedObj = { ...obj1 };
const mergedObj = { ...obj1, ...obj2 };
```

### 3. Promise.finally()
æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œã€‚
```javascript
fetch('api/data')
  .then(response => response.json())
  .then(data => processData(data))
  .catch(error => handleError(error))
  .finally(() => {
    // æ¸…ç†å·¥ä½œ
    cleanup();
  });
```

### 4. æ­£åˆ™å¢å¼º
å‘½åæ•è·ç»„ã€s ä¿®é¥°ç¬¦ã€åè¡Œæ–­è¨€ç­‰ã€‚
```javascript
// å‘½åæ•è·ç»„
const re = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/;
const result = re.exec('2023-05-01');
console.log(result.groups.year); // '2023'

// s ä¿®é¥°ç¬¦ï¼ˆdotAllï¼‰
const re2 = /hello.world/s;
console.log(re2.test('hello\nworld')); // true

// åè¡Œæ–­è¨€
const re3 = /(?<=\$)\d+/;
console.log(re3.exec('$123')); // ['123']
```



## ES2019 (ES10)

**ç‰ˆæœ¬å½±å“ï¼š** ES2019 ä¸“æ³¨äºæå‡å¼€å‘ä½“éªŒï¼Œå¼•å…¥äº†å®ç”¨çš„æ•°ç»„æ‰å¹³åŒ–æ–¹æ³•å’Œå¯¹è±¡è½¬æ¢å·¥å…·ã€‚è¿™äº›ç‰¹æ€§è™½ç„¶çœ‹ä¼¼ç®€å•ï¼Œä½†åœ¨æ—¥å¸¸å¼€å‘ä¸­æå¤§åœ°ç®€åŒ–äº†å¸¸è§æ“ä½œï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç®€æ´æ€§ã€‚

### 1. Array.prototype.flat() å’Œ flatMap()
æ•°ç»„æ‰å¹³åŒ–å’Œæ˜ å°„ã€‚
```javascript
// flat
[1, 2, [3, 4]].flat(); // [1, 2, 3, 4]
[1, 2, [3, 4, [5, 6]]].flat(2); // [1, 2, 3, 4, 5, 6]

// flatMap
[1, 2, 3].flatMap(x => [x, x * 2]); // [1, 2, 2, 4, 3, 6]

// å®é™…åº”ç”¨
const sentences = ['Hello world', 'How are you'];
const words = sentences.flatMap(s => s.split(' '));
```

### 2. Object.fromEntries()
é”®å€¼å¯¹æ•°ç»„è½¬å¯¹è±¡ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const entries = [['name', 'John'], ['age', 30]];
const obj = Object.fromEntries(entries);
console.log(obj); // { name: 'John', age: 30 }

// å®é™…åº”ç”¨ï¼šURL å‚æ•°è§£æ
const params = new URLSearchParams('name=John&age=30');
const paramsObj = Object.fromEntries(params);
```

### 3. String.trimStart/trimEnd
å»é™¤å­—ç¬¦ä¸²é¦–å°¾ç©ºç™½ã€‚
```javascript
// trimStart
'  hello '.trimStart(); // 'hello '

// trimEnd
'  hello '.trimEnd(); // '  hello'

// å®é™…åº”ç”¨
function formatName(name) {
  return name.trimStart().trimEnd();
}
```

### 4. å¯é€‰ catch ç»‘å®š
catch å¯ä»¥çœç•¥ error å‚æ•°ã€‚
```javascript
try {
  // å¯èƒ½æŠ›å‡ºé”™è¯¯çš„ä»£ç 
} catch {
  // ä¸éœ€è¦ä½¿ç”¨ error å‚æ•°
  console.log('An error occurred');
}
```



## ES2020 (ES11)

**ç‰ˆæœ¬å½±å“ï¼š** ES2020 æ˜¯è¿‘å¹´æ¥æœ€å…·å½±å“åŠ›çš„ç‰ˆæœ¬ä¹‹ä¸€ï¼Œå¯é€‰é“¾å’Œç©ºå€¼åˆå¹¶æ“ä½œç¬¦å½»åº•æ”¹å˜äº† JavaScript ä¸­å¤„ç†ä¸ç¡®å®šæ•°æ®çš„æ–¹å¼ï¼Œå¤§å¹…å‡å°‘äº†é˜²å¾¡æ€§ç¼–ç¨‹ä»£ç ã€‚BigInt å’ŒåŠ¨æ€ import åˆ™ä¸ºç‰¹å®šåœºæ™¯æä¾›äº†å¼ºå¤§çš„æ–°èƒ½åŠ›ã€‚

### 1. å¯é€‰é“¾æ“ä½œç¬¦ (Optional Chaining)
å®‰å…¨è®¿é—®å¤šå±‚åµŒå¥—å±æ€§ã€‚
```javascript
// å¯¹è±¡å±æ€§è®¿é—®
const value = obj?.prop?.nested?.value;

// æ•°ç»„å…ƒç´ è®¿é—®
const first = arr?.[0];

// å‡½æ•°è°ƒç”¨
const result = obj.method?.();

// å®é™…åº”ç”¨
function getCity(user) {
  return user?.address?.city ?? 'Unknown';
}
```

### 2. ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ (Nullish Coalescing)
åªåœ¨ null æˆ– undefined æ—¶ä½¿ç”¨é»˜è®¤å€¼ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const value = null ?? 'default';
const count = 0 ?? 42; // 0

// ä¸ || çš„åŒºåˆ«
const value1 = 0 || 42; // 42
const value2 = 0 ?? 42; // 0

// å®é™…åº”ç”¨
function greet(name) {
  return `Hello, ${name ?? 'Guest'}!`;
}
```

### 3. BigInt
æ”¯æŒä»»æ„ç²¾åº¦æ•´æ•°ã€‚
```javascript
// åˆ›å»º BigInt
const bigInt = 9007199254740991n;
const bigInt2 = BigInt(9007199254740991);

// è¿ç®—
const sum = bigInt + 1n;
const product = bigInt * 2n;

// å®é™…åº”ç”¨ï¼šå¤§æ•°è®¡ç®—
function calculateFactorial(n) {
  let result = 1n;
  for (let i = 2n; i <= n; i++) {
    result *= i;
  }
  return result;
}
```

### 4. Promise.allSettled()
æ‰€æœ‰ Promise å®Œæˆåè¿”å›æ¯ä¸ªç»“æœã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
Promise.allSettled([
  Promise.resolve(1),
  Promise.reject('error'),
  Promise.resolve(3)
]).then(results => {
  console.log(results);
  // [
  //   { status: 'fulfilled', value: 1 },
  //   { status: 'rejected', reason: 'error' },
  //   { status: 'fulfilled', value: 3 }
  // ]
});

// å®é™…åº”ç”¨ï¼šæ‰¹é‡è¯·æ±‚
async function fetchAll(urls) {
  const results = await Promise.allSettled(
    urls.map(url => fetch(url))
  );
  return results.map(result => 
    result.status === 'fulfilled' ? result.value : null
  );
}
```

### 5. globalThis
ç»Ÿä¸€å…¨å±€å¯¹è±¡ã€‚
```javascript
// æµè§ˆå™¨ç¯å¢ƒ
console.log(globalThis === window); // true

// Node.js ç¯å¢ƒ
console.log(globalThis === global); // true

// å®é™…åº”ç”¨
function getGlobal() {
  return globalThis;
}
```

### 6. åŠ¨æ€ import
æŒ‰éœ€å¼‚æ­¥åŠ è½½æ¨¡å—ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const module = await import('./module.js');

// æ¡ä»¶å¯¼å…¥
if (condition) {
  const { default: Component } = await import('./Component.js');
}

// å®é™…åº”ç”¨ï¼šè·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/about',
    component: () => import('./About.js')
  }
];
```



## ES2021 (ES12)

**ç‰ˆæœ¬å½±å“ï¼š** ES2021 ç»§ç»­å®Œå–„è¯­è¨€çš„å®ç”¨æ€§ï¼ŒreplaceAll() è§£å†³äº†é•¿æœŸå­˜åœ¨çš„å­—ç¬¦ä¸²æ›¿æ¢ç—›ç‚¹ï¼Œé€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ç®€åŒ–äº†å¸¸è§çš„èµ‹å€¼æ¨¡å¼ï¼ŒPromise.any() ä¸°å¯Œäº†å¼‚æ­¥ç¼–ç¨‹çš„é€‰æ‹©ã€‚

### 1. String.prototype.replaceAll()
å…¨éƒ¨æ›¿æ¢å­—ç¬¦ä¸²ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
'hello world'.replaceAll('o', '0'); // 'hell0 w0rld'

// ä¸ replace çš„åŒºåˆ«
'hello world'.replace(/o/g, '0'); // éœ€è¦æ­£åˆ™
'hello world'.replaceAll('o', '0'); // ç›´æ¥ä½¿ç”¨å­—ç¬¦ä¸²

// å®é™…åº”ç”¨
function sanitizeHTML(str) {
  return str.replaceAll('<', '&lt;').replaceAll('>', '&gt;');
}
```

### 2. Promise.any()
åªè¦æœ‰ä¸€ä¸ª Promise æˆåŠŸå°±è¿”å›ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
Promise.any([
  Promise.reject('error1'),
  Promise.resolve('success'),
  Promise.reject('error2')
]).then(result => {
  console.log(result); // 'success'
});

// å®é™…åº”ç”¨ï¼šå¤šæºæ•°æ®è·å–
async function fetchFromAnySource(urls) {
  try {
    const result = await Promise.any(
      urls.map(url => fetch(url).then(r => r.json()))
    );
    return result;
  } catch (error) {
    console.error('All requests failed');
  }
}
```

### 3. é€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ (Logical Assignment)
ç®€åŒ–èµ‹å€¼é€»è¾‘ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
let x = 1;
x ||= 2; // x = x || 2
x &&= 3; // x = x && 3
x ??= 4; // x = x ?? 4

// å®é™…åº”ç”¨
function updateConfig(config) {
  config.timeout ??= 1000;
  config.retries ||= 3;
  return config;
}
```

### 4. WeakRef & FinalizationRegistry
å¼±å¼•ç”¨å’Œç»ˆç»“å™¨ï¼Œé€‚åˆç¼“å­˜ç­‰åœºæ™¯ã€‚
```javascript
// WeakRef
const cache = new Map();
function getCachedData(key) {
  let ref = cache.get(key);
  if (ref) {
    const value = ref.deref();
    if (value) return value;
  }
  const value = computeExpensiveValue();
  cache.set(key, new WeakRef(value));
  return value;
}

// FinalizationRegistry
const registry = new FinalizationRegistry(heldValue => {
  console.log(`Cleaning up: ${heldValue}`);
});

registry.register(target, 'some value');
```



## ES2022 (ES13)

**ç‰ˆæœ¬å½±å“ï¼š** ES2022 æ˜¾è‘—å¢å¼ºäº†ç±»çš„åŠŸèƒ½ï¼Œå¼•å…¥äº†ç§æœ‰å­—æ®µå’Œé™æ€å­—æ®µï¼Œä½¿ JavaScript çš„é¢å‘å¯¹è±¡ç¼–ç¨‹æ›´åŠ å®Œå–„ã€‚é¡¶å±‚ await ç®€åŒ–äº†æ¨¡å—çš„å¼‚æ­¥åˆå§‹åŒ–ï¼Œè¿™äº›ç‰¹æ€§è®© JavaScript åœ¨å¤§å‹åº”ç”¨å¼€å‘ä¸­æ›´åŠ æˆç†Ÿã€‚

### 1. Class å­—æ®µå£°æ˜ (Class Fields)
ç±»å­—æ®µå’Œç§æœ‰å­—æ®µã€‚
```javascript
class Person {
  // å…¬å…±å­—æ®µ
  name = 'John';
  
  // ç§æœ‰å­—æ®µ
  #privateField = 'private';
  
  // é™æ€å­—æ®µ
  static count = 0;
  
  // ç§æœ‰é™æ€å­—æ®µ
  static #privateStaticField = 'private static';
  
  constructor() {
    Person.count++;
  }
  
  getPrivateField() {
    return this.#privateField;
  }
}
```

### 2. Top-level await
æ¨¡å—é¡¶å±‚ç›´æ¥ä½¿ç”¨ awaitã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const response = await fetch('api/data');
const data = await response.json();

// å®é™…åº”ç”¨ï¼šæ¨¡å—åˆå§‹åŒ–
const config = await loadConfig();
export const api = createAPI(config);
```

### 3. Object.hasOwn()
åˆ¤æ–­å¯¹è±¡è‡ªèº«å±æ€§ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const obj = { prop: 'value' };
console.log(Object.hasOwn(obj, 'prop')); // true
console.log(Object.hasOwn(obj, 'toString')); // false

// ä¸ hasOwnProperty çš„åŒºåˆ«
const obj2 = Object.create(null);
obj2.prop = 'value';
console.log(obj2.hasOwnProperty('prop')); // é”™è¯¯
console.log(Object.hasOwn(obj2, 'prop')); // true
```

### 4. Error cause
é”™è¯¯é“¾è·¯ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
try {
  throw new Error('fail', { cause: 'reason' });
} catch (e) {
  console.log(e.cause); // 'reason'
}

// å®é™…åº”ç”¨ï¼šé”™è¯¯ä¼ æ’­
async function fetchData() {
  try {
    const response = await fetch('api/data');
    if (!response.ok) {
      throw new Error('HTTP error', { 
        cause: { status: response.status }
      });
    }
    return response.json();
  } catch (error) {
    throw new Error('Failed to fetch data', { cause: error });
  }
}
```



## ES2023 (ES14)

**ç‰ˆæœ¬å½±å“ï¼š** ES2023 ä¸“æ³¨äºå¡«è¡¥åŠŸèƒ½ç©ºç™½ï¼ŒfindLast/findLastIndex è¡¥å…¨äº†æ•°ç»„æŸ¥æ‰¾æ–¹æ³•ï¼ŒWeakMap/WeakSet å¯¹ Symbol çš„æ”¯æŒå¢å¼ºäº†å…ƒç¼–ç¨‹èƒ½åŠ›ã€‚è™½ç„¶ç‰¹æ€§ä¸å¤šï¼Œä½†éƒ½æ˜¯å®ç”¨çš„å¢å¼ºã€‚

### 1. Array.prototype.findLast / findLastIndex
ä»æ•°ç»„æœ«å°¾æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æˆ–ç´¢å¼•ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const arr = [1, 2, 3, 4, 5];
arr.findLast(x => x % 2 === 0); // 4
arr.findLastIndex(x => x % 2 === 0); // 3

// å®é™…åº”ç”¨ï¼šæŸ¥æ‰¾æœ€åä¸€ä¸ªåŒ¹é…é¡¹
const logs = [
  { id: 1, status: 'success' },
  { id: 2, status: 'error' },
  { id: 3, status: 'success' }
];
const lastSuccess = logs.findLast(log => log.status === 'success');
```

### 2. WeakMap å’Œ WeakSet æ”¯æŒ Symbol é”®
```javascript
// åŸºæœ¬ç”¨æ³•
const weakMap = new WeakMap();
const symbol = Symbol('key');
weakMap.set(symbol, 'value');

// å®é™…åº”ç”¨ï¼šç§æœ‰æ•°æ®å­˜å‚¨
const privateData = new WeakMap();
class MyClass {
  constructor() {
    privateData.set(this, {
      secret: 'value'
    });
  }
  
  getSecret() {
    return privateData.get(this).secret;
  }
}
```

### 3. Hashbang æ”¯æŒ
å…è®¸è„šæœ¬ä»¥ `#!` å¼€å¤´ã€‚
```javascript
#!/usr/bin/env node
// ç°åœ¨å¯ä»¥ç›´æ¥è¿è¡Œè„šæœ¬
console.log('Hello, world!');
```



## ES2024 (ES15)

**ç‰ˆæœ¬å½±å“ï¼š** ES2024 å¸¦æ¥äº†å¤šä¸ªé‡è¦çš„å®ç”¨ç‰¹æ€§ï¼ŒObject.groupBy() ç®€åŒ–äº†æ•°æ®åˆ†ç»„æ“ä½œï¼ŒPromise.withResolvers() æä¾›äº†æ›´çµæ´»çš„ Promise åˆ›å»ºæ–¹å¼ï¼ŒRegExp v æ ‡å¿—å¢å¼ºäº†æ­£åˆ™è¡¨è¾¾å¼èƒ½åŠ›ï¼Œè¿™äº›ç‰¹æ€§è¿›ä¸€æ­¥æå‡äº† JavaScript çš„å¼€å‘æ•ˆç‡ã€‚

### 1. ArrayBuffer å’Œ SharedArrayBuffer å¢å¼º
æ”¯æŒå¯è°ƒæ•´å¤§å°çš„ ArrayBuffer å’Œ SharedArrayBufferï¼Œä»¥åŠä¼ è¾“åŠŸèƒ½ã€‚
```javascript
// å¯è°ƒæ•´å¤§å°çš„ ArrayBuffer
const buffer = new ArrayBuffer(8, { maxByteLength: 16 });
console.log(buffer.resizable); // true
console.log(buffer.maxByteLength); // 16

// è°ƒæ•´å¤§å°
buffer.resize(12);
console.log(buffer.byteLength); // 12

// ä¼ è¾“ ArrayBuffer
const newBuffer = buffer.transfer(20);
console.log(newBuffer.byteLength); // 20
console.log(buffer.detached); // true

// SharedArrayBuffer ä¹Ÿæ”¯æŒç±»ä¼¼åŠŸèƒ½
const sharedBuffer = new SharedArrayBuffer(8, { maxByteLength: 16 });
sharedBuffer.grow(12); // åªèƒ½å¢é•¿ï¼Œä¸èƒ½ç¼©å°
```

### 2. Promise.withResolvers()
æä¾›ä¾¿æ·çš„æ–¹å¼åˆ›å»º Promise åŠå…¶ resolve/reject å‡½æ•°ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const { promise, resolve, reject } = Promise.withResolvers();

// å¼‚æ­¥æ“ä½œ
setTimeout(() => {
  resolve('Success!');
}, 1000);

// å®é™…åº”ç”¨ï¼šåˆ›å»ºå¯æ§åˆ¶çš„ Promise
class AsyncQueue {
  constructor() {
    this.queue = [];
    this.processing = false;
  }
  
  add(task) {
    const { promise, resolve, reject } = Promise.withResolvers();
    this.queue.push({ task, resolve, reject });
    this.process();
    return promise;
  }
  
  async process() {
    if (this.processing) return;
    this.processing = true;
    
    while (this.queue.length > 0) {
      const { task, resolve, reject } = this.queue.shift();
      try {
        const result = await task();
        resolve(result);
      } catch (error) {
        reject(error);
      }
    }
    
    this.processing = false;
  }
}
```

### 3. Object.groupBy() å’Œ Map.groupBy()
æ ¹æ®å›è°ƒå‡½æ•°ç»“æœå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ã€‚
```javascript
// Object.groupBy
const users = [
  { name: 'Alice', age: 25, department: 'Engineering' },
  { name: 'Bob', age: 30, department: 'Marketing' },
  { name: 'Charlie', age: 35, department: 'Engineering' }
];

const byDepartment = Object.groupBy(users, user => user.department);
// {
//   Engineering: [{ name: 'Alice', ... }, { name: 'Charlie', ... }],
//   Marketing: [{ name: 'Bob', ... }]
// }

// Map.groupBy
const ageGroups = Map.groupBy(users, user => {
  if (user.age < 30) return 'young';
  if (user.age < 40) return 'middle';
  return 'senior';
});
// Map {
//   'young' => [{ name: 'Alice', ... }],
//   'middle' => [{ name: 'Bob', ... }, { name: 'Charlie', ... }]
// }

// å®é™…åº”ç”¨ï¼šæ•°æ®åˆ†æ
function analyzeData(data) {
  const statusGroups = Object.groupBy(data, item => item.status);
  const summary = Object.entries(statusGroups).map(([status, items]) => ({
    status,
    count: items.length,
    total: items.reduce((sum, item) => sum + item.value, 0)
  }));
  return summary;
}
```

### 4. RegExp v æ ‡å¿—
å¢å¼ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ”¯æŒé›†åˆè¡¨ç¤ºæ³•å’Œå­—ç¬¦ä¸²å±æ€§ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const regex = /[\p{Script=Latin}&&[^\p{ASCII}]]/v;
console.log(regex.test('cafÃ©')); // true

// é›†åˆæ“ä½œ
const emojiRegex = /[\p{Emoji}--\p{ASCII}]/v;
console.log(emojiRegex.test('ğŸ˜€')); // true
console.log(emojiRegex.test('A')); // false

// å­—ç¬¦ä¸²å­—é¢é‡
const stringSetRegex = /["hello"|"world"]/v;
console.log(stringSetRegex.test('hello')); // true

// å®é™…åº”ç”¨ï¼šå¤æ‚å­—ç¬¦åŒ¹é…
function validateUsername(username) {
  // å…è®¸å­—æ¯ã€æ•°å­—ï¼Œä½†æ’é™¤æŸäº›ç‰¹æ®Šå­—ç¬¦
  const validChars = /^[\p{L}\p{N}--[\p{Emoji}\p{Symbol}]]+$/v;
  return validChars.test(username);
}
```

### 5. Atomics.waitAsync()
å¼‚æ­¥ç­‰å¾…å…±äº«å†…å­˜å˜åŒ–ã€‚
```javascript
// åŸºæœ¬ç”¨æ³•
const sharedBuffer = new SharedArrayBuffer(4);
const view = new Int32Array(sharedBuffer);

// å¼‚æ­¥ç­‰å¾…
const result = Atomics.waitAsync(view, 0, 0);
if (result.async) {
  result.value.then(() => {
    console.log('Value changed!');
  });
}

// åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­
Atomics.store(view, 0, 1);
Atomics.notify(view, 0, 1);

// å®é™…åº”ç”¨ï¼šå¤šçº¿ç¨‹åè°ƒ
class SharedCounter {
  constructor() {
    this.buffer = new SharedArrayBuffer(4);
    this.view = new Int32Array(this.buffer);
  }
  
  async waitForValue(expectedValue) {
    const result = Atomics.waitAsync(this.view, 0, expectedValue);
    if (result.async) {
      await result.value;
    }
    return Atomics.load(this.view, 0);
  }
  
  increment() {
    Atomics.add(this.view, 0, 1);
    Atomics.notify(this.view, 0, 1);
  }
}
```

### 6. String.prototype.isWellFormed() å’Œ toWellFormed()
æ£€æŸ¥å’Œç¡®ä¿å­—ç¬¦ä¸²åŒ…å«æ ¼å¼è‰¯å¥½çš„ Unicodeã€‚
```javascript
// æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦æ ¼å¼è‰¯å¥½
const wellFormed = 'Hello ğŸ‘‹';
const malformed = 'Hello \uD83D'; // å­¤ç«‹çš„é«˜ä»£ç†é¡¹

console.log(wellFormed.isWellFormed()); // true
console.log(malformed.isWellFormed()); // false

// ä¿®å¤æ ¼å¼é”™è¯¯çš„å­—ç¬¦ä¸²
console.log(malformed.toWellFormed()); // 'Hello ï¿½'

// å®é™…åº”ç”¨ï¼šå®‰å…¨çš„å­—ç¬¦ä¸²å¤„ç†
function safeStringOperation(str) {
  if (!str.isWellFormed()) {
    console.warn('String contains malformed Unicode, fixing...');
    str = str.toWellFormed();
  }
  return str.toUpperCase();
}

// ç”¨äº API å“åº”å¤„ç†
function processApiResponse(response) {
  if (typeof response === 'string' && !response.isWellFormed()) {
    response = response.toWellFormed();
  }
  return JSON.parse(response);
}
```



## ES2025 (ES16)

**ç‰ˆæœ¬å½±å“ï¼š** ES2025 å¼•å…¥äº†æœŸå¾…å·²ä¹…çš„ Iterator Helpersï¼Œä¸º JavaScript å¸¦æ¥äº†ç±»ä¼¼å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚Set æ–¹æ³•æ‰©å±•å®Œå–„äº†é›†åˆæ“ä½œï¼ŒPromise.try() ç»Ÿä¸€äº†åŒæ­¥å¼‚æ­¥å¤„ç†ï¼Œè¿™äº›ç‰¹æ€§å°†æ˜¾è‘—æ”¹å–„æ•°æ®å¤„ç†å’Œå‡½æ•°å¼ç¼–ç¨‹çš„ä½“éªŒã€‚

### 1. Iterator Helpers
ä¸ºè¿­ä»£å™¨æä¾›ä¸°å¯Œçš„è¾…åŠ©æ–¹æ³•ï¼Œç±»ä¼¼äºæ•°ç»„æ–¹æ³•ã€‚<mcreference link="https://tc39.es/ecma262/" index="3">3</mcreference>
```javascript
// åŸºæœ¬ç”¨æ³•
function* numbers() {
  yield 1;
  yield 2;
  yield 3;
  yield 4;
  yield 5;
}

// é“¾å¼è°ƒç”¨
const result = numbers()
  .filter(x => x % 2 === 0)
  .map(x => x * 2)
  .take(2)
  .toArray();
console.log(result); // [4, 8]

// æ›´å¤šæ–¹æ³•
const iterator = numbers();
iterator.drop(2).next().value; // 3
iterator.forEach(x => console.log(x));
iterator.some(x => x > 3); // true
iterator.every(x => x > 0); // true
iterator.find(x => x > 2); // 3
iterator.reduce((acc, x) => acc + x, 0); // 15

// å®é™…åº”ç”¨ï¼šæ•°æ®æµå¤„ç†
function* fetchData() {
  for (let i = 1; i <= 100; i++) {
    yield fetch(`/api/data/${i}`).then(r => r.json());
  }
}

// å¤„ç†å‰10ä¸ªæœ‰æ•ˆæ•°æ®
const validData = fetchData()
  .filter(async data => (await data).valid)
  .take(10)
  .toArray();
```

### 2. Set æ–¹æ³•æ‰©å±•
ä¸º Set æ·»åŠ æ•°å­¦é›†åˆæ“ä½œæ–¹æ³•ã€‚<mcreference link="https://deliciousinsights.github.io/nordicjs-es2025/" index="2">2</mcreference>
```javascript
// åŸºæœ¬é›†åˆæ“ä½œ
const setA = new Set([1, 2, 3, 4]);
const setB = new Set([3, 4, 5, 6]);

// å¹¶é›†
const union = setA.union(setB);
console.log([...union]); // [1, 2, 3, 4, 5, 6]

// äº¤é›†
const intersection = setA.intersection(setB);
console.log([...intersection]); // [3, 4]

// å·®é›†
const difference = setA.difference(setB);
console.log([...difference]); // [1, 2]

// å¯¹ç§°å·®é›†
const symmetricDifference = setA.symmetricDifference(setB);
console.log([...symmetricDifference]); // [1, 2, 5, 6]

// å­é›†æ£€æŸ¥
console.log(new Set([1, 2]).isSubsetOf(setA)); // true
console.log(setA.isSupersetOf(new Set([1, 2]))); // true
console.log(setA.isDisjointFrom(new Set([7, 8]))); // true

// å®é™…åº”ç”¨ï¼šæƒé™ç®¡ç†
class PermissionManager {
  constructor() {
    this.userPermissions = new Map();
    this.rolePermissions = new Map();
  }
  
  getUserEffectivePermissions(userId) {
    const userPerms = this.userPermissions.get(userId) || new Set();
    const rolePerms = this.getUserRolePermissions(userId);
    return userPerms.union(rolePerms);
  }
  
  hasConflictingPermissions(userId, requiredPerms) {
    const effectivePerms = this.getUserEffectivePermissions(userId);
    return !requiredPerms.isSubsetOf(effectivePerms);
  }
}
```

### 3. Promise.try()
å®‰å…¨åœ°æ‰§è¡Œå¯èƒ½åŒæ­¥æˆ–å¼‚æ­¥çš„å‡½æ•°ã€‚<mcreference link="https://github.com/tc39/proposals/blob/main/finished-proposals.md" index="1">1</mcreference>
```javascript
// åŸºæœ¬ç”¨æ³•
const result = await Promise.try(() => {
  // å¯èƒ½æ˜¯åŒæ­¥æˆ–å¼‚æ­¥çš„å‡½æ•°
  return Math.random() > 0.5 ? 'sync' : Promise.resolve('async');
});

// é”™è¯¯å¤„ç†
const safeResult = await Promise.try(() => {
  if (Math.random() > 0.5) {
    throw new Error('Something went wrong');
  }
  return 'success';
}).catch(error => {
  console.error('Caught error:', error.message);
  return 'fallback';
});

// å®é™…åº”ç”¨ï¼šç»Ÿä¸€å¼‚æ­¥å¤„ç†
class DataProcessor {
  async processData(processor, data) {
    return Promise.try(() => processor(data))
      .then(result => this.validateResult(result))
      .catch(error => this.handleError(error));
  }
  
  validateResult(result) {
    if (!result || typeof result !== 'object') {
      throw new Error('Invalid result format');
    }
    return result;
  }
  
  handleError(error) {
    console.error('Processing failed:', error);
    return { error: error.message, success: false };
  }
}
```

### 4. RegExp.escape()
å®‰å…¨åœ°è½¬ä¹‰å­—ç¬¦ä¸²ç”¨äºæ­£åˆ™è¡¨è¾¾å¼ã€‚<mcreference link="https://tc39.es/ecma262/" index="3">3</mcreference>
```javascript
// åŸºæœ¬ç”¨æ³•
const userInput = 'Hello (world) [test]';
const escaped = RegExp.escape(userInput);
console.log(escaped); // 'Hello \\(world\\) \\[test\\]'

// åˆ›å»ºå®‰å…¨çš„æ­£åˆ™è¡¨è¾¾å¼
const regex = new RegExp(RegExp.escape(userInput));
console.log(regex.test('Hello (world) [test]')); // true

// å®é™…åº”ç”¨ï¼šæœç´¢åŠŸèƒ½
class SearchEngine {
  search(text, query) {
    const escapedQuery = RegExp.escape(query);
    const regex = new RegExp(escapedQuery, 'gi');
    return text.match(regex) || [];
  }
  
  highlight(text, query) {
    const escapedQuery = RegExp.escape(query);
    const regex = new RegExp(`(${escapedQuery})`, 'gi');
    return text.replace(regex, '<mark>$1</mark>');
  }
  
  fuzzySearch(text, query) {
    const escapedQuery = RegExp.escape(query);
    const fuzzyPattern = escapedQuery.split('').join('.*?');
    const regex = new RegExp(fuzzyPattern, 'i');
    return regex.test(text);
  }
}
```

### 5. Float16Array æ”¯æŒ
æ·»åŠ åŠç²¾åº¦æµ®ç‚¹æ•°ç±»å‹æ•°ç»„æ”¯æŒã€‚<mcreference link="https://www.infoworld.com/article/3856449/ecmascript-2025-javascript-standard-takes-shape.html" index="5">5</mcreference>
```javascript
// åˆ›å»º Float16Array
const float16Array = new Float16Array(4);
float16Array[0] = 1.5;
float16Array[1] = 2.25;
float16Array[2] = 3.75;
float16Array[3] = 4.125;

console.log(float16Array); // Float16Array [1.5, 2.25, 3.75, 4.125]

// Math.f16round æ–¹æ³•
const rounded = Math.f16round(1.23456789);
console.log(rounded); // 1.234375 (åŠç²¾åº¦ç²¾åº¦)

// DataView æ”¯æŒ
const buffer = new ArrayBuffer(8);
const view = new DataView(buffer);
view.setFloat16(0, 1.5);
view.setFloat16(2, 2.5);
console.log(view.getFloat16(0)); // 1.5
console.log(view.getFloat16(2)); // 2.5

// å®é™…åº”ç”¨ï¼šå›¾å½¢å¤„ç†
class ImageProcessor {
  constructor(width, height) {
    this.width = width;
    this.height = height;
    // ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°èŠ‚çœå†…å­˜
    this.pixels = new Float16Array(width * height * 4); // RGBA
  }
  
  setPixel(x, y, r, g, b, a = 1.0) {
    const index = (y * this.width + x) * 4;
    this.pixels[index] = Math.f16round(r);
    this.pixels[index + 1] = Math.f16round(g);
    this.pixels[index + 2] = Math.f16round(b);
    this.pixels[index + 3] = Math.f16round(a);
  }
  
  getPixel(x, y) {
    const index = (y * this.width + x) * 4;
    return {
      r: this.pixels[index],
      g: this.pixels[index + 1],
      b: this.pixels[index + 2],
      a: this.pixels[index + 3]
    };
  }
}
```

### 6. JSON æ¨¡å—å¯¼å…¥
æ”¯æŒç›´æ¥å¯¼å…¥ JSON æ–‡ä»¶ä½œä¸ºæ¨¡å—ã€‚<mcreference link="https://tc39.es/ecma262/" index="3">3</mcreference>
```javascript
// å¯¼å…¥ JSON æ–‡ä»¶
import config from './config.json' with { type: 'json' };
import data from './data.json' with { type: 'json' };

// ä½¿ç”¨å¯¼å…¥çš„æ•°æ®
console.log(config.apiUrl);
console.log(data.users);

// åŠ¨æ€å¯¼å…¥
const settings = await import('./settings.json', {
  with: { type: 'json' }
});

// å®é™…åº”ç”¨ï¼šé…ç½®ç®¡ç†
class ConfigManager {
  async loadConfig(environment) {
    const configPath = `./config/${environment}.json`;
    const config = await import(configPath, {
      with: { type: 'json' }
    });
    return config.default;
  }
  
  async loadLocalization(locale) {
    const localizationPath = `./i18n/${locale}.json`;
    try {
      const messages = await import(localizationPath, {
        with: { type: 'json' }
      });
      return messages.default;
    } catch (error) {
      // å›é€€åˆ°é»˜è®¤è¯­è¨€
      const fallback = await import('./i18n/en.json', {
        with: { type: 'json' }
      });
      return fallback.default;
    }
  }
}
```

### 7. æ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦
æ”¯æŒåœ¨æ­£åˆ™è¡¨è¾¾å¼å†…éƒ¨å¯ç”¨å’Œç¦ç”¨ä¿®é¥°ç¬¦ã€‚<mcreference link="https://tc39.es/ecma262/" index="3">3</mcreference>
```javascript
// å†…è”ä¿®é¥°ç¬¦
const regex1 = /(?i)hello/; // ç­‰ä»·äº /hello/i
const regex2 = /(?-i:WORLD)/i; // åœ¨å¤§å°å†™ä¸æ•æ„Ÿæ¨¡å¼ä¸­ï¼ŒWORLD éƒ¨åˆ†å¤§å°å†™æ•æ„Ÿ

// ç»„åˆä½¿ç”¨
const regex3 = /(?i)hello(?-i: WORLD)/;
console.log(regex3.test('Hello WORLD')); // true
console.log(regex3.test('Hello world')); // false

// å¤šè¡Œæ¨¡å¼åˆ‡æ¢
const regex4 = /^(?m)start.*?(?-m)end$/;

// å®é™…åº”ç”¨ï¼šå¤æ‚æ–‡æœ¬è§£æ
class TextParser {
  parseDocument(text) {
    // æ ‡é¢˜ï¼šå¤§å°å†™ä¸æ•æ„Ÿ
    // å†…å®¹ï¼šå¤§å°å†™æ•æ„Ÿ
    const headerRegex = /(?i)^#\s+(.+)$(?-i)/gm;
    const headers = [...text.matchAll(headerRegex)];
    
    return headers.map(match => ({
      title: match[1],
      level: match[0].indexOf('#') + 1
    }));
  }
  
  extractCodeBlocks(text) {
    // åœ¨å¤šè¡Œæ¨¡å¼ä¸­åŒ¹é…ä»£ç å—
    const codeRegex = /(?s)```(?i)(\w+)?(?-i)\n(.*?)\n```/g;
    const blocks = [...text.matchAll(codeRegex)];
    
    return blocks.map(match => ({
      language: match[1] || 'text',
      code: match[2]
    }));
  }
}
```



## è‰æ¡ˆç‰¹æ€§åˆé›† (Draft Features Collection)

### 1. è£…é¥°å™¨ï¼ˆDecoratorsï¼ŒStage 3ï¼‰
ä¸ºç±»å’Œç±»æˆå‘˜æ·»åŠ å…ƒç¼–ç¨‹æ³¨è§£å’Œè¡Œä¸ºæ‰©å±•ã€‚**å½“å‰çŠ¶æ€ï¼šStage 3ï¼Œé¢„è®¡2025å¹´è¿›å…¥Stage 4**

**è§£å†³ç—›ç‚¹ï¼š**
- ç¼ºä¹æ ‡å‡†åŒ–çš„å…ƒç¼–ç¨‹æœºåˆ¶
- éœ€è¦å¤æ‚çš„ä»£ç æ¥å®ç°æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆå¦‚æ—¥å¿—ã€éªŒè¯ã€ç¼“å­˜ï¼‰
- æ¡†æ¶é—´è£…é¥°å™¨è¯­æ³•ä¸ç»Ÿä¸€

```javascript
// ç±»è£…é¥°å™¨
@sealed
class Example {
  // æ–¹æ³•è£…é¥°å™¨
  @readonly
  @logged
  method() {
    return 'Hello World';
  }
  
  // å±æ€§è£…é¥°å™¨
  @validate
  name = '';
  
  // è®¿é—®å™¨è£…é¥°å™¨
  @cached
  get computedValue() {
    return this.expensiveCalculation();
  }
}

// è£…é¥°å™¨å®ç°
function sealed(constructor) {
  Object.seal(constructor);
  Object.seal(constructor.prototype);
  return constructor;
}

function readonly(target, context) {
  if (context.kind === 'method') {
    return function(...args) {
      const result = target.call(this, ...args);
      Object.freeze(result);
      return result;
    };
  }
}

function logged(target, context) {
  return function(...args) {
    console.log(`Calling ${context.name} with args:`, args);
    const result = target.call(this, ...args);
    console.log(`${context.name} returned:`, result);
    return result;
  };
}

function validate(target, context) {
  return {
    get() {
      return target.get.call(this);
    },
    set(value) {
      if (typeof value !== 'string') {
        throw new Error(`${context.name} must be a string`);
      }
      return target.set.call(this, value);
    },
    init(value) {
      if (typeof value !== 'string') {
        throw new Error(`${context.name} must be a string`);
      }
      return value;
    }
  };
}

// å®é™…åº”ç”¨ï¼šAPI æ§åˆ¶å™¨
class UserController {
  @authenticated
  @rateLimit(100) // æ¯åˆ†é’Ÿ100æ¬¡è¯·æ±‚
  @validate({ schema: userSchema })
  async createUser(userData) {
    return await this.userService.create(userData);
  }
  
  @cached(300) // ç¼“å­˜5åˆ†é’Ÿ
  @authorized('admin')
  async getUsers() {
    return await this.userService.findAll();
  }
}
```

### 2. ç®¡é“æ“ä½œç¬¦ï¼ˆPipeline Operatorï¼ŒStage 2ï¼‰
æä¾›å‡½æ•°å¼ç¼–ç¨‹é£æ ¼çš„æ•°æ®æµå¤„ç†ã€‚**å½“å‰çŠ¶æ€ï¼šStage 2ï¼Œè¯­æ³•ä»åœ¨è®¨è®ºä¸­**

**è§£å†³ç—›ç‚¹ï¼š**
- æ·±åº¦åµŒå¥—çš„å‡½æ•°è°ƒç”¨éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤
- ç¼ºä¹æ¸…æ™°çš„æ•°æ®æµè¡¨è¾¾æ–¹å¼
- ä¸´æ—¶å˜é‡æ±¡æŸ“ä½œç”¨åŸŸ

**å½“å‰ææ¡ˆæœ‰ä¸¤ç§è¯­æ³•é€‰æ‹©ï¼š**

#### Hack-style ç®¡é“ï¼ˆ|>ï¼‰
```javascript
// ä¼ ç»Ÿå†™æ³•
const result = Math.round(Math.abs(Math.sqrt(16)));

// ç®¡é“æ“ä½œç¬¦å†™æ³•
const result = 16
  |> Math.sqrt(%)
  |> Math.abs(%)
  |> Math.round(%);

// å¤æ‚æ•°æ®å¤„ç†
const processData = data => data
  |> %.filter(item => item.active)
  |> %.map(item => ({ ...item, processed: true }))
  |> %.sort((a, b) => a.priority - b.priority);

// å¼‚æ­¥ç®¡é“
const fetchUserData = userId => userId
  |> await fetchUser(%)
  |> await fetchUserPosts(%)
  |> await enrichWithMetadata(%);
```

#### F#-style ç®¡é“ï¼ˆ|>ï¼‰
```javascript
// F# é£æ ¼ï¼ˆæ¯ä¸ªé˜¶æ®µå¿…é¡»æ˜¯å•å‚æ•°å‡½æ•°ï¼‰
const result = 16
  |> Math.sqrt
  |> Math.abs
  |> Math.round;

// éœ€è¦é€‚é…å™¨å‡½æ•°å¤„ç†å¤šå‚æ•°
const processUser = user => user
  |> validateUser
  |> u => updateDatabase(u, { timestamp: Date.now() })
  |> u => sendNotification(u, 'updated');

// å®é™…åº”ç”¨ï¼šæ•°æ®è½¬æ¢ç®¡é“
const transformApiResponse = response => response
  |> JSON.parse
  |> data => data.results
  |> results => results.filter(item => item.status === 'active')
  |> items => items.map(normalizeItem)
  |> items => items.sort(byPriority);
```

**ææ¡ˆçŠ¶æ€è¯´æ˜ï¼š**
- ç›®å‰ TC39 å§”å‘˜ä¼šåœ¨ä¸¤ç§è¯­æ³•é—´çŠ¹è±«
- Hack-style æ›´çµæ´»ä½†è¯­æ³•å¤æ‚
- F#-style æ›´ç®€æ´ä½†é™åˆ¶è¾ƒå¤š
- é¢„è®¡2025å¹´ç¡®å®šæœ€ç»ˆè¯­æ³•æ–¹æ¡ˆ

### 3. éƒ¨åˆ†åº”ç”¨ï¼ˆPartial Applicationï¼ŒStage 1ï¼‰
å…è®¸ç”¨ `?` å ä½ç¬¦é¢„å…ˆå¡«å……éƒ¨åˆ†å‚æ•°ï¼Œè¿”å›æ–°å‡½æ•°ã€‚**å½“å‰çŠ¶æ€ï¼šStage 1ï¼Œææ¡ˆè¢«é‡æ–°è®¾è®¡**

**è§£å†³ç—›ç‚¹ï¼š**
- æ‰‹åŠ¨åˆ›å»ºæŸ¯é‡ŒåŒ–å‡½æ•°ç¹ç
- ç¼ºä¹æ ‡å‡†çš„éƒ¨åˆ†åº”ç”¨è¯­æ³•
- å‡½æ•°ç»„åˆå’Œå¤ç”¨å›°éš¾

**æ³¨æ„ï¼šè¯¥ææ¡ˆç›®å‰å¤„äºé‡æ–°è®¾è®¡é˜¶æ®µï¼Œè¯­æ³•å¯èƒ½å‘ç”Ÿå˜åŒ–**

```javascript
// åŸºæœ¬ç”¨æ³•ï¼ˆå½“å‰ææ¡ˆè¯­æ³•ï¼‰
const add = (a, b, c) => a + b + c;
const addFive = add(5, ?, ?);
const addFiveAndThree = add(5, 3, ?);

console.log(addFive(2, 3)); // 10
console.log(addFiveAndThree(1)); // 9

// å¤æ‚å‚æ•°æ¨¡å¼
const processData = (config, data, options, callback) => {
  // æ•°æ®å¤„ç†é€»è¾‘
};

// é¢„è®¾é…ç½®å’Œé€‰é¡¹
const processWithDefaults = processData(defaultConfig, ?, defaultOptions, ?);

// ä½¿ç”¨
processWithDefaults(userData, handleResult);
processWithDefaults(apiData, logResult);

// å®é™…åº”ç”¨ï¼šAPI è°ƒç”¨
const apiCall = (method, url, headers, body) => {
  return fetch(url, { method, headers, body });
};

// é¢„è®¾ API é…ç½®
const postToAPI = apiCall('POST', ?, authHeaders, ?);
const getFromAPI = apiCall('GET', ?, authHeaders, null);

// ä½¿ç”¨
const createUser = postToAPI('/users', JSON.stringify(userData));
const fetchUsers = getFromAPI('/users');

// äº‹ä»¶å¤„ç†åº”ç”¨
const handleEvent = (element, eventType, handler, options) => {
  element.addEventListener(eventType, handler, options);
};

// é¢„è®¾å…ƒç´ å’Œé€‰é¡¹
const addClickHandler = handleEvent(button, 'click', ?, { once: true });
const addHoverHandler = handleEvent(?, 'mouseenter', ?, false);

// ä½¿ç”¨
addClickHandler(submitForm);
addHoverHandler(tooltip, showTooltip);
```

**ææ¡ˆçŠ¶æ€è¯´æ˜ï¼š**
- åŸ Stage 2 ææ¡ˆå› å¤æ‚æ€§é—®é¢˜è¢«é™çº§
- ç›®å‰åœ¨é‡æ–°è®¾è®¡æ›´ç®€æ´çš„è¯­æ³•
- ä¸ç®¡é“æ“ä½œç¬¦ææ¡ˆå­˜åœ¨è¯­æ³•å†²çªéœ€è¦è§£å†³
- é¢„è®¡2025-2026å¹´é‡æ–°è¿›å…¥ Stage 2

### 4. æ¨¡å¼åŒ¹é…ï¼ˆPattern Matchingï¼ŒStage 1ï¼‰
ç±»ä¼¼äº switchï¼Œä½†æ”¯æŒç»“æ„åŒ–åŒ¹é…å’Œè§£æ„ã€‚**å½“å‰çŠ¶æ€ï¼šStage 1ï¼Œè¯­æ³•è®¾è®¡ä¸­**

**è§£å†³ç—›ç‚¹ï¼š**
- switch è¯­å¥åŠŸèƒ½æœ‰é™ï¼Œä¸æ”¯æŒå¤æ‚åŒ¹é…
- ç¼ºä¹ç»“æ„åŒ–æ•°æ®çš„ä¼˜é›…å¤„ç†æ–¹å¼
- æ¡ä»¶é€»è¾‘å¤æ‚æ—¶ä»£ç å†—é•¿

**æ³¨æ„ï¼šè¯­æ³•ä»åœ¨è®¾è®¡é˜¶æ®µï¼Œä»¥ä¸‹ä¸ºææ¡ˆä¸­çš„è¯­æ³•ç¤ºä¾‹**

```javascript
// åŸºæœ¬æ¨¡å¼åŒ¹é…ï¼ˆææ¡ˆè¯­æ³•ï¼‰
const result = match (value) {
  when 0 -> 'zero',
  when 1 -> 'one',
  when Number if (value > 1) -> 'big number',
  when String -> 'text',
  when _ -> 'unknown'
};

// å¯¹è±¡è§£æ„åŒ¹é…
const handleResponse = match (response) {
  when { status: 200, data } -> data,
  when { status: 404 } -> null,
  when { status, error } if (status >= 400) -> throw new Error(error),
  when _ -> response
};

// æ•°ç»„æ¨¡å¼åŒ¹é…
const processArray = match (arr) {
  when [] -> 'empty',
  when [x] -> `single: ${x}`,
  when [x, y] -> `pair: ${x}, ${y}`,
  when [head, ...tail] -> `head: ${head}, tail: ${tail.length}`,
  when _ -> 'other'
};

// å¤æ‚åµŒå¥—åŒ¹é…
const handleApiResult = match (result) {
  when { success: true, data: { user: { name, age } } } if (age >= 18) -> 
    `Adult user: ${name}`,
  when { success: true, data: { user: { name } } } -> 
    `Minor user: ${name}`,
  when { success: false, error: { code: 404 } } -> 
    'User not found',
  when { success: false, error: { code, message } } -> 
    `Error ${code}: ${message}`,
  when _ -> 'Unknown response format'
};

// ç±»å‹åŒ¹é…ï¼ˆå‡è®¾æœ‰ç±»å‹ç³»ç»Ÿï¼‰
const processValue = match (value) {
  when String if (value.length > 10) -> 'long string',
  when String -> 'short string',
  when Number if (value % 2 === 0) -> 'even number',
  when Number -> 'odd number',
  when Boolean -> 'boolean value',
  when Array -> `array with ${value.length} items`,
  when Object -> 'object',
  when null -> 'null value',
  when undefined -> 'undefined value',
  when _ -> 'unknown type'
};

// å®é™…åº”ç”¨ï¼šçŠ¶æ€æœº
const handleState = (state, action) => match ([state, action]) {
  when ['idle', { type: 'START' }] -> 'loading',
  when ['loading', { type: 'SUCCESS', data }] -> { state: 'success', data },
  when ['loading', { type: 'ERROR', error }] -> { state: 'error', error },
  when ['success', { type: 'RESET' }] -> 'idle',
  when ['error', { type: 'RETRY' }] -> 'loading',
  when [currentState, _] -> currentState // ä¿æŒå½“å‰çŠ¶æ€
};
```

**ææ¡ˆçŠ¶æ€è¯´æ˜ï¼š**
- 2018å¹´5æœˆè¿›å…¥ Stage 1
- è¯­æ³•è®¾è®¡ä»åœ¨è®¨è®ºä¸­ï¼Œå­˜åœ¨å¤šä¸ªç«äº‰æ–¹æ¡ˆ
- éœ€è¦è§£å†³ä¸ç°æœ‰ switch è¯­å¥çš„å…¼å®¹æ€§
- æ€§èƒ½ä¼˜åŒ–å’Œç¼–è¯‘å™¨æ”¯æŒæ˜¯å…³é”®æŒ‘æˆ˜
- é¢„è®¡2026å¹´åæ‰å¯èƒ½è¿›å…¥ Stage 2

### 5. ç±»å‹æ³¨è§£ï¼ˆType Annotationsï¼ŒStage 1ï¼‰
ä¸º JS ä»£ç æ·»åŠ ç±»å‹æ³¨è§£ï¼Œæœªæ¥å¯ç”¨äºç±»å‹æ£€æŸ¥å’Œ IDE æ™ºèƒ½æç¤ºã€‚**å½“å‰çŠ¶æ€ï¼šStage 1ï¼Œè¯­æ³•è§„èŒƒåˆ¶å®šä¸­**

**è§£å†³ç—›ç‚¹ï¼š**
- JavaScript ç¼ºä¹åŸç”Ÿç±»å‹ç³»ç»Ÿ
- è¿è¡Œæ—¶é”™è¯¯éš¾ä»¥åœ¨å¼€å‘é˜¶æ®µå‘ç°
- IDE æ™ºèƒ½æç¤ºå’Œé‡æ„æ”¯æŒæœ‰é™
- TypeScript éœ€è¦ç¼–è¯‘æ­¥éª¤

**æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªä»…è¯­æ³•ææ¡ˆï¼Œä¸åŒ…å«è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥**

```javascript
// å‡½æ•°ç±»å‹æ³¨è§£ï¼ˆææ¡ˆè¯­æ³•ï¼‰
function add(a: number, b: number): number {
  return a + b;
}

// å˜é‡ç±»å‹æ³¨è§£
let name: string = 'John';
let age: number = 30;
let isActive: boolean = true;
let items: Array<string> = ['a', 'b', 'c'];

// å¯¹è±¡ç±»å‹æ³¨è§£
interface User {
  id: number;
  name: string;
  email?: string;
  roles: string[];
}

const user: User = {
  id: 1,
  name: 'Alice',
  roles: ['admin']
};

// ç±»å‹åˆ«å
type Status = 'pending' | 'approved' | 'rejected';
type EventHandler = (event: Event) => void;

// æ³›å‹å‡½æ•°
function identity<T>(arg: T): T {
  return arg;
}

function map<T, U>(array: T[], fn: (item: T) => U): U[] {
  return array.map(fn);
}

// ç±»çš„ç±»å‹æ³¨è§£
class ApiClient {
  private baseUrl: string;
  
  constructor(baseUrl: string) {
    this.baseUrl = baseUrl;
  }
  
  async get<T>(endpoint: string): Promise<T> {
    const response = await fetch(`${this.baseUrl}${endpoint}`);
    return response.json();
  }
  
  async post<T, U>(endpoint: string, data: T): Promise<U> {
    const response = await fetch(`${this.baseUrl}${endpoint}`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });
    return response.json();
  }
}

// å¤æ‚ç±»å‹ç»„åˆ
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: number;
    message: string;
  };
}

type UserCreateRequest = {
  name: string;
  email: string;
  password: string;
};

type UserResponse = ApiResponse<User>;

// å®é™…åº”ç”¨ç¤ºä¾‹
class UserService {
  private client: ApiClient;
  
  constructor(client: ApiClient) {
    this.client = client;
  }
  
  async createUser(userData: UserCreateRequest): Promise<UserResponse> {
    return this.client.post<UserCreateRequest, UserResponse>('/users', userData);
  }
  
  async getUser(id: number): Promise<UserResponse> {
    return this.client.get<UserResponse>(`/users/${id}`);
  }
  
  async updateUser(id: number, updates: Partial<User>): Promise<UserResponse> {
    return this.client.post<Partial<User>, UserResponse>(`/users/${id}`, updates);
  }
}
```

**ææ¡ˆçŠ¶æ€è¯´æ˜ï¼š**
- è¿™æ˜¯ä¸€ä¸ª"ä»…è¯­æ³•"ææ¡ˆï¼Œç±»å‹æ³¨è§£åœ¨è¿è¡Œæ—¶ä¼šè¢«å¿½ç•¥
- ç›®æ ‡æ˜¯è®©å·¥å…·ï¼ˆå¦‚ TypeScriptã€Flowï¼‰èƒ½å¤Ÿç›´æ¥å¤„ç† JS æ–‡ä»¶
- ä¸åŒ…å«è¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼Œä¿æŒ JS çš„åŠ¨æ€ç‰¹æ€§
- è¯­æ³•è®¾è®¡éœ€è¦ä¸ TypeScript ä¿æŒå…¼å®¹
- é¢„è®¡2025-2026å¹´è¿›å…¥ Stage 2

### 6. Array.prototype.groupByï¼ˆå·²ç§»è‡³ Object.groupByï¼ŒES2024ï¼‰
æ ¹æ®å›è°ƒç»“æœåˆ†ç»„æ•°ç»„å…ƒç´ ã€‚**å½“å‰çŠ¶æ€ï¼šå·²åœ¨ ES2024 ä¸­ä½œä¸º Object.groupBy å®ç°**

**è§£å†³ç—›ç‚¹ï¼š**
- æ‰‹åŠ¨åˆ†ç»„æ•°ç»„å…ƒç´ ä»£ç å†—é•¿
- ç¼ºä¹æ ‡å‡†çš„æ•°ç»„åˆ†ç»„æ–¹æ³•
- éœ€è¦ä½¿ç”¨ reduce ç­‰å¤æ‚æ“ä½œ

**æ³¨æ„ï¼šåŸ Array.prototype.groupBy ææ¡ˆè¢«é‡æ–°è®¾è®¡ä¸º Object.groupBy**

```javascript
const people = [
  { name: 'Alice', age: 25, department: 'Engineering' },
  { name: 'Bob', age: 30, department: 'Marketing' },
  { name: 'Charlie', age: 35, department: 'Engineering' },
  { name: 'Diana', age: 28, department: 'Marketing' }
];

// ä½¿ç”¨ Object.groupByï¼ˆES2024ï¼‰
const byDepartment = Object.groupBy(people, person => person.department);
// {
//   Engineering: [{ name: 'Alice', ... }, { name: 'Charlie', ... }],
//   Marketing: [{ name: 'Bob', ... }, { name: 'Diana', ... }]
// }

// æŒ‰å¹´é¾„æ®µåˆ†ç»„
const byAgeGroup = Object.groupBy(people, person => {
  if (person.age < 30) return 'young';
  return 'senior';
});
// {
//   young: [{ name: 'Alice', ... }, { name: 'Diana', ... }],
//   senior: [{ name: 'Bob', ... }, { name: 'Charlie', ... }]
// }

// ä½¿ç”¨ Map.groupBy å¤„ç†éå­—ç¬¦ä¸²é”®
const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
const byParity = Map.groupBy(numbers, n => n % 2 === 0);
// Map {
//   false => [1, 3, 5, 7, 9],
//   true => [2, 4, 6, 8, 10]
// }

// å¤æ‚åˆ†ç»„é€»è¾‘
const transactions = [
  { id: 1, amount: 100, type: 'credit', date: '2024-01-15' },
  { id: 2, amount: 50, type: 'debit', date: '2024-01-15' },
  { id: 3, amount: 200, type: 'credit', date: '2024-01-16' },
  { id: 4, amount: 75, type: 'debit', date: '2024-01-16' }
];

// æŒ‰æ—¥æœŸå’Œç±»å‹åˆ†ç»„
const byDateAndType = Object.groupBy(transactions, t => `${t.date}-${t.type}`);
// {
//   '2024-01-15-credit': [{ id: 1, ... }],
//   '2024-01-15-debit': [{ id: 2, ... }],
//   '2024-01-16-credit': [{ id: 3, ... }],
//   '2024-01-16-debit': [{ id: 4, ... }]
// }
```

**ææ¡ˆæ¼”è¿›å†å²ï¼š**
- æœ€åˆä½œä¸º Array.prototype.groupBy ææ¡ˆ
- å› åŸå‹æ±¡æŸ“å’Œæ€§èƒ½è€ƒè™‘ï¼Œæ”¹ä¸ºé™æ€æ–¹æ³•
- ES2024 ä¸­å®ç°ä¸º Object.groupBy å’Œ Map.groupBy
- è§£å†³äº†æ•°ç»„åˆ†ç»„çš„æ ‡å‡†åŒ–éœ€æ±‚

### 7. Array.prototype.toSorted / toReversed / toSplicedï¼ˆå·²åœ¨ ES2023 å®ç°ï¼‰
ä¸å¯å˜æ•°ç»„æ“ä½œæ–¹æ³•ã€‚**å½“å‰çŠ¶æ€ï¼šå·²åœ¨ ES2023 ä¸­å®ç°**

**è§£å†³ç—›ç‚¹ï¼š**
- åŸæœ‰æ•°ç»„æ–¹æ³•ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œä¸ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹ç†å¿µ
- éœ€è¦æ‰‹åŠ¨å¤åˆ¶æ•°ç»„å†æ“ä½œï¼Œä»£ç å†—é•¿
- ç¼ºä¹æ ‡å‡†çš„ä¸å¯å˜æ•°ç»„æ“ä½œæ–¹æ³•

```javascript
const original = [3, 1, 4, 1, 5];

// ä¸å¯å˜æ’åº
const sorted = original.toSorted();
console.log(original); // [3, 1, 4, 1, 5] (æœªæ”¹å˜)
console.log(sorted);   // [1, 1, 3, 4, 5]

// è‡ªå®šä¹‰æ’åº
const people = [
  { name: 'Alice', age: 30 },
  { name: 'Bob', age: 25 },
  { name: 'Charlie', age: 35 }
];
const sortedByAge = people.toSorted((a, b) => a.age - b.age);

// ä¸å¯å˜åè½¬
const reversed = original.toReversed();
console.log(reversed); // [5, 1, 4, 1, 3]

// ä¸å¯å˜æ‹¼æ¥
const spliced = original.toSpliced(1, 2, 'a', 'b');
console.log(spliced); // [3, 'a', 'b', 1, 5]

// ç»„åˆä½¿ç”¨
const data = [10, 5, 8, 3, 1];
const processed = data
  .toSorted((a, b) => b - a)  // é™åºæ’åº
  .toSpliced(0, 2)            // ç§»é™¤å‰ä¸¤ä¸ªå…ƒç´ 
  .toReversed();              // åè½¬
console.log(processed); // [3, 8]
console.log(data);      // [10, 5, 8, 3, 1] (åŸæ•°ç»„æœªå˜)

// å®é™…åº”ç”¨ï¼šçŠ¶æ€ç®¡ç†
class TodoList {
  constructor(items = []) {
    this.items = items;
  }
  
  addItem(item) {
    return new TodoList(this.items.toSpliced(this.items.length, 0, item));
  }
  
  removeItem(index) {
    return new TodoList(this.items.toSpliced(index, 1));
  }
  
  sortByPriority() {
    return new TodoList(this.items.toSorted((a, b) => a.priority - b.priority));
  }
  
  reverse() {
    return new TodoList(this.items.toReversed());
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const todos = new TodoList([
  { id: 1, text: 'Learn JavaScript', priority: 2 },
  { id: 2, text: 'Build app', priority: 1 },
  { id: 3, text: 'Deploy', priority: 3 }
]);

const sortedTodos = todos.sortByPriority();
const reversedTodos = sortedTodos.reverse();
```

**å®ç°çŠ¶æ€ï¼š**
- ES2023 ä¸­å·²æ­£å¼å®ç°
- æ‰€æœ‰ä¸»æµæµè§ˆå™¨å·²æ”¯æŒ
- ä¸ç°æœ‰æ•°ç»„æ–¹æ³•ä¿æŒä¸€è‡´çš„ API è®¾è®¡
- ä¸ºå‡½æ•°å¼ç¼–ç¨‹æä¾›äº†é‡è¦æ”¯æŒ

### 8. Set æ–¹æ³•æ‰©å±•ï¼ˆå·²åœ¨ ES2025 å®ç°ï¼‰
Set.prototype.intersection, difference, union, symmetricDifference ç­‰æ–¹æ³•ã€‚**å½“å‰çŠ¶æ€ï¼šå·²åœ¨ ES2025 ä¸­å®ç°**

**è§£å†³ç—›ç‚¹ï¼š**
- ç¼ºä¹æ ‡å‡†çš„é›†åˆè¿ç®—æ–¹æ³•
- éœ€è¦æ‰‹åŠ¨å®ç°é›†åˆçš„äº¤é›†ã€å¹¶é›†ç­‰æ“ä½œ
- ä»£ç å†—é•¿ä¸”å®¹æ˜“å‡ºé”™

```javascript
const setA = new Set([1, 2, 3, 4]);
const setB = new Set([3, 4, 5, 6]);

// äº¤é›† - ä¸¤ä¸ªé›†åˆçš„å…±åŒå…ƒç´ 
const intersection = setA.intersection(setB); // Set {3, 4}

// å·®é›† - setA ä¸­æœ‰ä½† setB ä¸­æ²¡æœ‰çš„å…ƒç´ 
const difference = setA.difference(setB); // Set {1, 2}

// å¹¶é›† - ä¸¤ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼ˆå»é‡ï¼‰
const union = setA.union(setB); // Set {1, 2, 3, 4, 5, 6}

// å¯¹ç§°å·®é›† - ä¸¤ä¸ªé›†åˆä¸­ä¸å…±åŒçš„å…ƒç´ 
const symmetricDiff = setA.symmetricDifference(setB); // Set {1, 2, 5, 6}

// åˆ¤æ–­æ–¹æ³•
const isDisjoint = setA.isDisjointFrom(setB); // false (æœ‰äº¤é›†)
const isSubset = new Set([1, 2]).isSubsetOf(setA); // true
const isSuperset = setA.isSupersetOf(new Set([1, 2])); // true

// å®é™…åº”ç”¨ï¼šæƒé™ç®¡ç†
class PermissionManager {
  constructor() {
    this.userPermissions = new Map();
    this.rolePermissions = new Map();
  }
  
  // è®¾ç½®ç”¨æˆ·æƒé™
  setUserPermissions(userId, permissions) {
    this.userPermissions.set(userId, new Set(permissions));
  }
  
  // è®¾ç½®è§’è‰²æƒé™
  setRolePermissions(role, permissions) {
    this.rolePermissions.set(role, new Set(permissions));
  }
  
  // è·å–ç”¨æˆ·æœ‰æ•ˆæƒé™ï¼ˆç”¨æˆ·æƒé™ + è§’è‰²æƒé™ï¼‰
  getEffectivePermissions(userId, roles) {
    const userPerms = this.userPermissions.get(userId) || new Set();
    
    // åˆå¹¶æ‰€æœ‰è§’è‰²æƒé™
    const rolePerms = roles.reduce((acc, role) => {
      const perms = this.rolePermissions.get(role) || new Set();
      return acc.union(perms);
    }, new Set());
    
    // è¿”å›ç”¨æˆ·æƒé™å’Œè§’è‰²æƒé™çš„å¹¶é›†
    return userPerms.union(rolePerms);
  }
  
  // æ£€æŸ¥æƒé™å†²çª
  checkPermissionConflicts(permissions1, permissions2) {
    const conflicts = permissions1.intersection(permissions2);
    return conflicts.size > 0 ? conflicts : null;
  }
  
  // è·å–ç¼ºå¤±æƒé™
  getMissingPermissions(required, current) {
    return required.difference(current);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
const pm = new PermissionManager();

// è®¾ç½®è§’è‰²æƒé™
pm.setRolePermissions('admin', ['read', 'write', 'delete', 'manage']);
pm.setRolePermissions('editor', ['read', 'write']);
pm.setRolePermissions('viewer', ['read']);

// è®¾ç½®ç”¨æˆ·æƒé™
pm.setUserPermissions('user1', ['read', 'comment']);

// è·å–ç”¨æˆ·æœ‰æ•ˆæƒé™
const userPerms = pm.getEffectivePermissions('user1', ['editor']);
console.log(userPerms); // Set {'read', 'write', 'comment'}

// æ£€æŸ¥æƒé™
const required = new Set(['read', 'write', 'delete']);
const missing = pm.getMissingPermissions(required, userPerms);
console.log(missing); // Set {'delete'}
```

**å®ç°çŠ¶æ€ï¼š**
- ES2025 ä¸­å·²æ­£å¼å®ç°
- æä¾›äº†å®Œæ•´çš„é›†åˆè¿ç®— API
- åŒ…å«åˆ¤æ–­æ–¹æ³•ï¼šisDisjointFrom, isSubsetOf, isSupersetOf
- ä¸ºæ•°æ®åˆ†æå’Œæƒé™ç®¡ç†æä¾›äº†å¼ºå¤§æ”¯æŒ

### 9. Symbol.metadataï¼ˆStage 3ï¼‰
ä¸ºç±»å’Œå¯¹è±¡æä¾›å…ƒæ•°æ®å­˜å‚¨ã€‚**å½“å‰çŠ¶æ€ï¼šStage 3ï¼Œä¸è£…é¥°å™¨ææ¡ˆå¯†åˆ‡ç›¸å…³**

**è§£å†³ç—›ç‚¹ï¼š**
- ç¼ºä¹æ ‡å‡†çš„å…ƒæ•°æ®å­˜å‚¨æœºåˆ¶
- æ¡†æ¶éœ€è¦è‡ªå®šä¹‰å…ƒæ•°æ®ç³»ç»Ÿ
- åå°„å’Œå…ƒç¼–ç¨‹æ”¯æŒä¸è¶³

**æ³¨æ„ï¼šè¯¥ç‰¹æ€§ä¸è£…é¥°å™¨ææ¡ˆç´§å¯†ç»“åˆï¼Œè¯­æ³•å¯èƒ½éšè£…é¥°å™¨ææ¡ˆå˜åŒ–**

```javascript
// åŸºæœ¬ç”¨æ³•ï¼ˆé…åˆè£…é¥°å™¨ï¼‰
function metadata(data) {
  return function(target, context) {
    // åœ¨è£…é¥°å™¨ä¸­è®¾ç½®å…ƒæ•°æ®
    if (!target[Symbol.metadata]) {
      target[Symbol.metadata] = {};
    }
    Object.assign(target[Symbol.metadata], data);
    return target;
  };
}

@metadata({ version: '1.0', author: 'developer' })
class MyClass {
  @metadata({ required: true, type: 'string' })
  property = 'value';
  
  @metadata({ deprecated: true, since: '2.0' })
  oldMethod() {
    return 'legacy';
  }
  
  @metadata({ async: true, timeout: 5000 })
  async newMethod() {
    return 'modern';
  }
}

// è®¿é—®å…ƒæ•°æ®
const classMetadata = MyClass[Symbol.metadata];
console.log(classMetadata); // { version: '1.0', author: 'developer' }

// å®é™…åº”ç”¨ï¼šAPI æ–‡æ¡£ç”Ÿæˆ
class ApiDocGenerator {
  static generateDocs(targetClass) {
    const metadata = targetClass[Symbol.metadata] || {};
    const docs = {
      className: targetClass.name,
      ...metadata,
      methods: [],
      properties: []
    };
    
    // éå†ç±»çš„æ–¹æ³•å’Œå±æ€§
    const prototype = targetClass.prototype;
    const propertyNames = Object.getOwnPropertyNames(prototype);
    
    propertyNames.forEach(name => {
      if (name !== 'constructor') {
        const descriptor = Object.getOwnPropertyDescriptor(prototype, name);
        if (descriptor && typeof descriptor.value === 'function') {
          const methodMetadata = descriptor.value[Symbol.metadata] || {};
          docs.methods.push({
            name,
            ...methodMetadata
          });
        }
      }
    });
    
    return docs;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
@metadata({ 
  description: 'User management service',
  version: '2.1.0',
  tags: ['user', 'auth']
})
class UserService {
  @metadata({ 
    description: 'Create a new user',
    parameters: [{ name: 'userData', type: 'object', required: true }],
    returns: { type: 'Promise<User>', description: 'Created user object' }
  })
  async createUser(userData) {
    // åˆ›å»ºç”¨æˆ·é€»è¾‘
    return { id: 1, ...userData };
  }
  
  @metadata({ 
    description: 'Get user by ID',
    parameters: [{ name: 'id', type: 'number', required: true }],
    returns: { type: 'Promise<User|null>', description: 'User object or null' },
    cache: { ttl: 300 }
  })
  async getUserById(id) {
    // è·å–ç”¨æˆ·é€»è¾‘
    return { id, name: 'John Doe' };
  }
  
  @metadata({ 
    description: 'Delete user',
    deprecated: true,
    since: '2.0.0',
    alternative: 'softDeleteUser'
  })
  async deleteUser(id) {
    // åˆ é™¤ç”¨æˆ·é€»è¾‘
  }
}

// ç”Ÿæˆ API æ–‡æ¡£
const apiDocs = ApiDocGenerator.generateDocs(UserService);
console.log(JSON.stringify(apiDocs, null, 2));

// è¿è¡Œæ—¶å…ƒæ•°æ®æ£€æŸ¥
class ValidationService {
  static validate(instance, methodName, args) {
    const method = instance.constructor.prototype[methodName];
    const metadata = method[Symbol.metadata];
    
    if (metadata && metadata.parameters) {
      metadata.parameters.forEach((param, index) => {
        if (param.required && args[index] === undefined) {
          throw new Error(`Parameter '${param.name}' is required`);
        }
        
        if (param.type && typeof args[index] !== param.type) {
          throw new Error(`Parameter '${param.name}' must be of type ${param.type}`);
        }
      });
    }
    
    if (metadata && metadata.deprecated) {
      console.warn(`Method '${methodName}' is deprecated since ${metadata.since}`);
      if (metadata.alternative) {
        console.warn(`Use '${metadata.alternative}' instead`);
      }
    }
  }
}
```

**ææ¡ˆçŠ¶æ€è¯´æ˜ï¼š**
- ç›®å‰å¤„äº Stage 3ï¼Œæ¥è¿‘æœ€ç»ˆç¡®å®š
- ä¸è£…é¥°å™¨ææ¡ˆç´§å¯†ç»“åˆï¼Œå…±åŒè¿›é€€
- ä¸ºåå°„å’Œå…ƒç¼–ç¨‹æä¾›æ ‡å‡†åŒ–æ”¯æŒ
- é¢„è®¡ä¸è£…é¥°å™¨ä¸€åŒåœ¨2025å¹´è¿›å…¥ Stage 4

---

*æœ¬æ–‡æ¡£ä¸“æ³¨äº ES2015-ES2025 å„ç‰ˆæœ¬çš„æ ¸å¿ƒç‰¹æ€§ä»‹ç»ï¼Œä¸º JavaScript å¼€å‘è€…æä¾›ç³»ç»Ÿæ€§çš„å­¦ä¹ å‚è€ƒã€‚*

